<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è - –û—Ñ—Ç–∞–ª—å–º–æ–≠–∫—Å–ø–µ—Ä—Ç</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
</head>
<body class="dashboard-page">
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <div class="navbar-content">
                <a href="{{ url_for('index') }}" class="logo logo-link">
                    <span class="logo-icon">üëÅÔ∏è</span>
                    <span class="logo-text">–û—Ñ—Ç–∞–ª—å–º–æ–≠–∫—Å–ø–µ—Ä—Ç</span>
                </a>
                <div class="nav-links">
                    <a href="{{ url_for('dashboard') }}" class="nav-link active">–ì–ª–∞–≤–Ω–∞—è</a>
                    <a href="{{ url_for('patient_list') }}" class="nav-link">–ü–∞—Ü–∏–µ–Ω—Ç—ã</a>
                    <a href="{{ url_for('consultation') }}" class="nav-link">–ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏</a>
                    <div class="user-menu">
                        <a href="{{ url_for('profile') }}" class="user-name" id="userName">–ó–∞–≥—Ä—É–∑–∫–∞...</a>
                        <a href="{{ url_for('logout') }}" class="btn btn-sm btn-secondary">–í—ã–π—Ç–∏</a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container main-content">
        <!-- Page Header -->
        <div class="page-header">
            <div class="header-content">
                <h1>–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</h1>
                <p class="text-muted" id="welcomeMessage">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å</p>
            </div>
            <div class="header-actions">
                <a href="{{ url_for('consultation') }}" class="btn btn-primary">
                    üÜï –ù–æ–≤–∞—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è
                </a>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="grid grid-2">
            <div class="action-card">
                <div class="action-icon">üë•</div>
                <div class="action-content">
                    <h3>–ù–æ–≤—ã–π –ø–∞—Ü–∏–µ–Ω—Ç</h3>
                    <p class="text-muted">–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ –ø–∞—Ü–∏–µ–Ω—Ç–∞ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö</p>
                    <a href="{{ url_for('patient_new') }}" class="btn btn-secondary">–î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ü–∏–µ–Ω—Ç–∞</a>
                </div>
            </div>
            
            <!-- –£–±—Ä–∞–Ω –±–ª–æ–∫ "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞" —Å –ø–æ–º–æ—â—å—é display:none -->
            <div class="action-card" style="display:none">
                <div class="action-icon">üìä</div>
                <div class="action-content">
                    <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                    <p class="text-muted">–ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏ –æ—Ç—á–µ—Ç–æ–≤</p>
                    <button class="btn btn-secondary">–û—Ç–∫—Ä—ã—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</button>
                </div>
            </div>
        </div>

        <!-- Recent Patients -->
        <div class="card">
            <div class="card-header">
                <h2>–°–ø–∏—Å–æ–∫ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤</h2>
            </div>
            <div class="card-content">
                {% if patients %}
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>–§–ò–û</th>
                                <th>–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è</th>
                                <th>–í–æ–∑—Ä–∞—Å—Ç</th>
                                <th>–ü–æ–ª</th>
                                <th>–¢–µ–ª–µ—Ñ–æ–Ω</th>
                                <th>Email</th>
                                <th>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</th>
                                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for patient in patients %}
                            <tr>
                                <td>#{{ patient.id }}</td>
                                <td>
                                    <div class="patient-info">
                                        <strong>{{ patient.last_name }} {{ patient.first_name }} {{ patient.middle_name or '' }}</strong>
                                        {% if patient.email %}
                                        <span class="text-muted text-sm">{{ patient.email }}</span>
                                        {% elif patient.phone %}
                                        <span class="text-muted text-sm">{{ patient.phone }}</span>
                                        {% endif %}
                                    </div>
                                </td>
                                <td>{{ patient.birthday.strftime('%d.%m.%Y') if patient.birthday else '–ù–µ —É–∫–∞–∑–∞–Ω–∞' }}</td>
                                <td>{{ patient.age }} –ª–µ—Ç</td>
                                <td>{{ '–ú—É–∂—Å–∫–æ–π' if patient.sex == 'M' else '–ñ–µ–Ω—Å–∫–∏–π' }}</td>
                                <td>{{ patient.phone or '–ù–µ —É–∫–∞–∑–∞–Ω' }}</td>
                                <td>{{ patient.email or '–ù–µ —É–∫–∞–∑–∞–Ω' }}</td>
                                <td>{{ patient.registered_at.strftime('%d.%m.%Y') if patient.registered_at else '–ù–µ —É–∫–∞–∑–∞–Ω–∞' }}</td>
                                <td>
                                    <div class="action-buttons">
                                        <a href="{{ url_for('patient_history', patient_id=patient.id) }}" class="btn btn-sm btn-secondary">
                                            üìã –ò—Å—Ç–æ—Ä–∏—è
                                        </a>
                                        <a href="{{ url_for('consultation', patient_id=patient.id) }}" class="btn btn-sm btn-primary">
                                            üÜï –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è
                                        </a>
                                    </div>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <div class="empty-state">
                    <div class="empty-state-icon">üë•</div>
                    <h3>–°–ø–∏—Å–æ–∫ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ –ø—É—Å—Ç</h3>
                    <p class="text-muted">–í —Å–∏—Å—Ç–µ–º–µ –ø–æ–∫–∞ –Ω–µ—Ç –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤–æ–≥–æ –ø–∞—Ü–∏–µ–Ω—Ç–∞, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É.</p>
                    <a href="{{ url_for('patient_new') }}" class="btn btn-primary">
                        üë• –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤–æ–≥–æ –ø–∞—Ü–∏–µ–Ω—Ç–∞
                    </a>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Recent Consultations -->
        <div class="card">
            <div class="card-header">
                <h2>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏</h2>
            </div>
            <div class="card-content">
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>–î–∞—Ç–∞</th>
                                <th>–ü–∞—Ü–∏–µ–Ω—Ç</th>
                                <th>–°–∏–º–ø—Ç–æ–º—ã</th>
                                <th>–î–∏–∞–≥–Ω–æ–∑</th>
                                <th>–°—Ç–∞—Ç—É—Å</th>
                                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>20.01.2024</td>
                                <td>–ü–µ—Ç—Ä–æ–≤ –ò–≤–∞–Ω –°–µ—Ä–≥–µ–µ–≤–∏—á</td>
                                <td>–ë–æ–ª—å, –ø–æ–∫—Ä–∞—Å–Ω–µ–Ω–∏–µ</td>
                                <td>–û—Å—Ç—Ä—ã–π –∫–æ–Ω—ä—é–Ω–∫—Ç–∏–≤–∏—Ç</td>
                                <td><span class="status-badge status-completed">–ó–∞–≤–µ—Ä—à–µ–Ω–∞</span></td>
                                <td>
                                    <a href="{{ url_for('consultation_result') }}" class="btn btn-sm btn-secondary">–ü—Ä–æ—Å–º–æ—Ç—Ä</a>
                                </td>
                            </tr>
                            <tr>
                                <td>19.01.2024</td>
                                <td>–°–∏–¥–æ—Ä–æ–≤–∞ –ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–Ω–∞</td>
                                <td>–£—Ö—É–¥—à–µ–Ω–∏–µ –∑—Ä–µ–Ω–∏—è</td>
                                <td>–ú–∏–æ–ø–∏—è</td>
                                <td><span class="status-badge status-completed">–ó–∞–≤–µ—Ä—à–µ–Ω–∞</span></td>
                                <td>
                                    <a href="{{ url_for('consultation_result') }}" class="btn btn-sm btn-secondary">–ü—Ä–æ—Å–º–æ—Ç—Ä</a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>

    <script src="{{ url_for('static', filename='js/auth.js') }}"></script>
</body>
</html>